Implements: #6027 Draft PR where i have all changes in api.c file. 

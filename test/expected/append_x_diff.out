--make sure diff only has explain output not result output
\! diff ../results/append_unoptimized.out ../results/append.out 
1c1
< \set DISABLE_OPTIMIZATIONS on
---
> \set DISABLE_OPTIMIZATIONS off
67,78c67,73
<                                     QUERY PLAN                                    
< ----------------------------------------------------------------------------------
<  Append
<    ->  Seq Scan on append_test
<          Filter: ("time" > (now_s() + '@ 1 mon'::interval))
<    ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<          Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<    ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<          Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
<    ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<          Index Cond: ("time" > (now_s() + '@ 1 mon'::interval))
< (9 rows)
---
> psql:include/append.sql:44: NOTICE:  Stable function now_s() called!
>              QUERY PLAN              
> -------------------------------------
>  Custom Scan (ConstraintAwareAppend)
>    Hypertable: append_test
>    ->  Append
> (3 rows)
86,87d80
< psql:include/append.sql:45: NOTICE:  Stable function now_s() called!
< psql:include/append.sql:45: NOTICE:  Stable function now_s() called!
102,113c95,103
<                                     QUERY PLAN                                    
< ----------------------------------------------------------------------------------
<  Append
<    ->  Seq Scan on append_test
<          Filter: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
< (9 rows)
---
> psql:include/append.sql:52: NOTICE:  Stable function now_s() called!
>                                        QUERY PLAN                                       
> ----------------------------------------------------------------------------------------
>  Custom Scan (ConstraintAwareAppend)
>    Hypertable: append_test
>    ->  Append
>          ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
>                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
> (5 rows)
123d112
< psql:include/append.sql:55: NOTICE:  Stable function now_s() called!
138,139c127,129
<                                            QUERY PLAN                                            
< -------------------------------------------------------------------------------------------------
---
> psql:include/append.sql:61: NOTICE:  Stable function now_s() called!
>                                               QUERY PLAN                                               
> -------------------------------------------------------------------------------------------------------
141,151c131,137
<    ->  Merge Append
<          Sort Key: append_test."time"
<          ->  Index Scan Backward using append_test_time_idx on append_test
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<          ->  Index Scan Backward using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<          ->  Index Scan Backward using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<          ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
< (11 rows)
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          ->  Merge Append
>                Sort Key: _hyper_1_3_chunk."time"
>                ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
>                      Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
> (7 rows)
162,163d147
< psql:include/append.sql:65: NOTICE:  Stable function now_s() called!
< psql:include/append.sql:65: NOTICE:  Stable function now_s() called!
197,198c181,182
<                             QUERY PLAN                             
< -------------------------------------------------------------------
---
>                                QUERY PLAN                                
> -------------------------------------------------------------------------
201,209c185,193
<    ->  Append
<          ->  Seq Scan on append_test
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
<          ->  Seq Scan on _hyper_1_1_chunk
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
<          ->  Seq Scan on _hyper_1_2_chunk
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
<          ->  Seq Scan on _hyper_1_3_chunk
<                Filter: ("time" > (now_v() - '@ 2 mons'::interval))
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          ->  Append
>                ->  Seq Scan on _hyper_1_1_chunk
>                      Filter: ("time" > (now_v() - '@ 2 mons'::interval))
>                ->  Seq Scan on _hyper_1_2_chunk
>                      Filter: ("time" > (now_v() - '@ 2 mons'::interval))
>                ->  Seq Scan on _hyper_1_3_chunk
>                      Filter: ("time" > (now_v() - '@ 2 mons'::interval))
236,237d219
< psql:include/append.sql:91: NOTICE:  Stable function now_s() called!
< psql:include/append.sql:91: NOTICE:  Stable function now_s() called!
245,257c227,236
<                                         QUERY PLAN                                         
< -------------------------------------------------------------------------------------------
<  Merge Append
<    Sort Key: append_test."time"
<    ->  Index Scan Backward using append_test_time_idx on append_test
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan Backward using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan Backward using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
<    ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
<          Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
< (10 rows)
---
> psql:include/append.sql:94: NOTICE:  Stable function now_s() called!
>                                            QUERY PLAN                                            
> -------------------------------------------------------------------------------------------------
>  Custom Scan (ConstraintAwareAppend)
>    Hypertable: append_test
>    ->  Merge Append
>          Sort Key: _hyper_1_3_chunk."time"
>          ->  Index Scan Backward using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk
>                Index Cond: ("time" > (now_s() - '@ 2 mons'::interval))
> (6 rows)
285a265
> psql:include/append.sql:107: NOTICE:  Stable function now_s() called!
292c272,273
<          ->  Result
---
>          ->  Custom Scan (ConstraintAwareAppend)
>                Hypertable: append_test
294,297d274
<                      ->  Seq Scan on append_test
<                            Filter: ("time" > (now_s() - '@ 4 mons'::interval))
<                      ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk
<                            Index Cond: ("time" > (now_s() - '@ 4 mons'::interval))
302c279
< (14 rows)
---
> (11 rows)
353,354c330,333
<                                          QUERY PLAN                                         
< --------------------------------------------------------------------------------------------
---
> psql:include/append.sql:136: NOTICE:  Stable function now_s() called!
> psql:include/append.sql:136: NOTICE:  Stable function now_s() called!
>                                             QUERY PLAN                                            
> --------------------------------------------------------------------------------------------------
357,375c336,350
<    ->  Append
<          ->  Seq Scan on append_test a
<                Filter: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_1_1_chunk_append_test_time_idx on _hyper_1_1_chunk a_1
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_1_2_chunk_append_test_time_idx on _hyper_1_2_chunk a_2
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk a_3
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<    ->  Append
<          ->  Seq Scan on join_test j
<                Filter: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_2_4_chunk_join_test_time_idx on _hyper_2_4_chunk j_1
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_2_5_chunk_join_test_time_idx on _hyper_2_5_chunk j_2
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
<          ->  Index Scan using _hyper_2_6_chunk_join_test_time_idx on _hyper_2_6_chunk j_3
<                Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
< (20 rows)
---
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: append_test
>          ->  Append
>                ->  Index Scan using _hyper_1_3_chunk_append_test_time_idx on _hyper_1_3_chunk a_1
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
>    ->  Custom Scan (ConstraintAwareAppend)
>          Hypertable: join_test
>          ->  Append
>                ->  Index Scan using _hyper_2_4_chunk_join_test_time_idx on _hyper_2_4_chunk j_1
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
>                ->  Index Scan using _hyper_2_5_chunk_join_test_time_idx on _hyper_2_5_chunk j_2
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
>                ->  Index Scan using _hyper_2_6_chunk_join_test_time_idx on _hyper_2_6_chunk j_3
>                      Index Cond: ("time" > (now_s() - '@ 3 hours'::interval))
> (16 rows)
